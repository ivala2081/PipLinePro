<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Automation Preview - PipLine Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Responsive Automation CSS -->
    <link href="{{ url_for('static', filename='css/base/responsive-automation.css') }}" rel="stylesheet">
    
    <style>
        /* Preview-specific styles */
        .preview-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
        }
        
        .viewport-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1000;
            min-width: 250px;
        }
        
        .viewport-controls h6 {
            margin-bottom: 10px;
            color: #333;
        }
        
        .viewport-controls .form-group {
            margin-bottom: 10px;
        }
        
        .viewport-controls label {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .viewport-controls input,
        .viewport-controls select {
            width: 100%;
            padding: 5px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.875rem;
        }
        
        .viewport-controls button {
            width: 100%;
            padding: 8px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.875rem;
            cursor: pointer;
        }
        
        .viewport-controls button:hover {
            background: #0056b3;
        }
        
        .preview-frame {
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
            background: white;
        }
        
        .preview-frame iframe {
            width: 100%;
            border: none;
            display: block;
        }
        
        .responsive-info {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .responsive-info h5 {
            color: #495057;
            margin-bottom: 10px;
        }
        
        .responsive-info .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .responsive-info .info-item {
            background: white;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        
        .responsive-info .info-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.875rem;
        }
        
        .responsive-info .info-value {
            color: #6c757d;
            font-size: 0.875rem;
            margin-top: 5px;
        }
        
        .test-components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .test-component {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .test-component h6 {
            color: #495057;
            margin-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 10px;
        }
        
        .breakpoint-indicator {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #28a745;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.875rem;
            font-weight: 600;
            z-index: 1000;
        }
        
        .breakpoint-indicator.xs { background: #dc3545; }
        .breakpoint-indicator.sm { background: #fd7e14; }
        .breakpoint-indicator.md { background: #ffc107; color: #212529; }
        .breakpoint-indicator.lg { background: #17a2b8; }
        .breakpoint-indicator.xl { background: #28a745; }
        .breakpoint-indicator.2xl { background: #6f42c1; }
        
        @media (max-width: 768px) {
            .viewport-controls {
                position: static;
                margin-bottom: 20px;
            }
            
            .breakpoint-indicator {
                position: static;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Breakpoint Indicator -->
    <div class="breakpoint-indicator" id="breakpointIndicator">
        Current: <span id="currentBreakpoint">lg</span>
    </div>
    
    <!-- Viewport Controls -->
    <div class="viewport-controls">
        <h6><i class="bi bi-gear"></i> Responsive Controls</h6>
        
        <div class="form-group">
            <label for="viewportWidth">Viewport Width (px)</label>
            <input type="number" id="viewportWidth" value="{{ viewport_width }}" min="320" max="2560" step="10">
        </div>
        
        <div class="form-group">
            <label for="viewportHeight">Viewport Height (px)</label>
            <input type="number" id="viewportHeight" value="800" min="400" max="1600" step="10">
        </div>
        
        <div class="form-group">
            <label for="presetSizes">Preset Sizes</label>
            <select id="presetSizes">
                <option value="">Custom</option>
                <option value="320">Mobile (320px)</option>
                <option value="576">Large Mobile (576px)</option>
                <option value="768">Tablet (768px)</option>
                <option value="992">Small Desktop (992px)</option>
                <option value="1200">Desktop (1200px)</option>
                <option value="1400">Large Desktop (1400px)</option>
            </select>
        </div>
        
        <button onclick="updateViewport()">Update Viewport</button>
        <button onclick="refreshPreview()" style="margin-top: 5px; background: #6c757d;">Refresh Preview</button>
    </div>
    
    <div class="preview-container">
        <h1><i class="bi bi-phone"></i> Responsive Automation Preview</h1>
        <p class="text-muted">Test responsive design automation with different viewport sizes</p>
        
        <!-- Responsive Information -->
        <div class="responsive-info">
            <h5><i class="bi bi-info-circle"></i> Responsive Configuration</h5>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Current Breakpoint</div>
                    <div class="info-value" id="configBreakpoint">{{ config.current_breakpoint }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Viewport Width</div>
                    <div class="info-value" id="configViewportWidth">{{ viewport_width }}px</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Scale Factor</div>
                    <div class="info-value" id="configScaleFactor">Calculating...</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Device Type</div>
                    <div class="info-value" id="configDeviceType">{{ 'Mobile' if config.is_mobile else 'Tablet' if config.is_tablet else 'Desktop' }}</div>
                </div>
            </div>
        </div>
        
        <!-- Preview Frame -->
        <div class="preview-frame">
            <iframe id="previewFrame" src="{{ url_for('auth.login') }}" width="{{ viewport_width }}" height="800"></iframe>
        </div>
        
        <!-- Test Components -->
        <div class="test-components">
            <div class="test-component">
                <h6><i class="bi bi-type"></i> Typography Test</h6>
                <h1>Heading 1 - Fluid Typography</h1>
                <h2>Heading 2 - Responsive Scale</h2>
                <h3>Heading 3 - Viewport Based</h3>
                <p>This paragraph demonstrates fluid typography that scales with the viewport size. The text automatically adjusts to maintain optimal readability across all device sizes.</p>
                <small>Small text for captions and notes</small>
            </div>
            
            <div class="test-component">
                <h6><i class="bi bi-grid"></i> Spacing Test</h6>
                <div style="padding: var(--fluid-space-md); background: #f8f9fa; border-radius: 4px; margin-bottom: var(--fluid-space-sm);">
                    Medium spacing padding
                </div>
                <div style="padding: var(--fluid-space-lg); background: #e9ecef; border-radius: 4px; margin-bottom: var(--fluid-space-sm);">
                    Large spacing padding
                </div>
                <div style="padding: var(--fluid-space-xl); background: #dee2e6; border-radius: 4px;">
                    Extra large spacing padding
                </div>
            </div>
            
            <div class="test-component">
                <h6><i class="bi bi-box"></i> Component Test</h6>
                <button class="btn btn-primary" style="margin-bottom: var(--fluid-space-sm);">Responsive Button</button>
                <input type="text" class="form-control" placeholder="Responsive Input" style="margin-bottom: var(--fluid-space-sm);">
                <div class="card" style="margin-bottom: var(--fluid-space-sm);">
                    <div class="card-body">
                        Responsive Card Component
                    </div>
                </div>
                <i class="bi bi-star icon-lg"></i>
                <i class="bi bi-heart icon-md"></i>
                <i class="bi bi-check icon-sm"></i>
            </div>
            
            <div class="test-component">
                <h6><i class="bi bi-phone"></i> Responsive Utilities</h6>
                <div class="d-none d-md-block" style="background: #d4edda; padding: 10px; border-radius: 4px; margin-bottom: 10px;">
                    Visible on medium screens and up
                </div>
                <div class="d-block d-md-none" style="background: #f8d7da; padding: 10px; border-radius: 4px; margin-bottom: 10px;">
                    Visible on small screens only
                </div>
                <div class="text-center text-md-left" style="background: #d1ecf1; padding: 10px; border-radius: 4px;">
                    Centered on mobile, left-aligned on desktop
                </div>
            </div>
        </div>
        
        <!-- Responsive Stats -->
        <div class="responsive-info">
            <h5><i class="bi bi-graph-up"></i> Responsive Statistics</h5>
            <div id="responsiveStats">Loading...</div>
        </div>
    </div>
    
    <!-- Responsive Automation JavaScript -->
    <script src="{{ url_for('static', filename='js/responsive-automation.js') }}"></script>
    
    <script>
        // Preview functionality
        let currentViewportWidth = {{ viewport_width }};
        let currentViewportHeight = 800;
        
        function updateViewport() {
            const width = parseInt(document.getElementById('viewportWidth').value);
            const height = parseInt(document.getElementById('viewportHeight').value);
            
            if (width >= 320 && width <= 2560) {
                currentViewportWidth = width;
                currentViewportHeight = height;
                
                // Update iframe
                const iframe = document.getElementById('previewFrame');
                iframe.style.width = width + 'px';
                iframe.style.height = height + 'px';
                
                // Update responsive info
                updateResponsiveInfo();
                
                // Update breakpoint indicator
                updateBreakpointIndicator();
                
                // Reload iframe with new responsive CSS
                setTimeout(() => {
                    iframe.src = iframe.src;
                }, 100);
            }
        }
        
        function refreshPreview() {
            const iframe = document.getElementById('previewFrame');
            iframe.src = iframe.src;
        }
        
        function updateResponsiveInfo() {
            // Update viewport width display
            document.getElementById('configViewportWidth').textContent = currentViewportWidth + 'px';
            
            // Calculate and update scale factor
            const scaleFactor = Math.min(currentViewportWidth / 1200, 1.5);
            document.getElementById('configScaleFactor').textContent = scaleFactor.toFixed(3);
            
            // Update device type
            let deviceType = 'Desktop';
            if (currentViewportWidth < 768) deviceType = 'Mobile';
            else if (currentViewportWidth < 992) deviceType = 'Tablet';
            
            document.getElementById('configDeviceType').textContent = deviceType;
        }
        
        function updateBreakpointIndicator() {
            let breakpoint = 'lg';
            if (currentViewportWidth < 576) breakpoint = 'xs';
            else if (currentViewportWidth < 768) breakpoint = 'sm';
            else if (currentViewportWidth < 992) breakpoint = 'md';
            else if (currentViewportWidth < 1200) breakpoint = 'lg';
            else if (currentViewportWidth < 1400) breakpoint = 'xl';
            else breakpoint = '2xl';
            
            document.getElementById('currentBreakpoint').textContent = breakpoint;
            
            // Update indicator class
            const indicator = document.getElementById('breakpointIndicator');
            indicator.className = 'breakpoint-indicator ' + breakpoint;
        }
        
        // Preset sizes handler
        document.getElementById('presetSizes').addEventListener('change', function() {
            const value = this.value;
            if (value) {
                document.getElementById('viewportWidth').value = value;
                updateViewport();
            }
        });
        
        // Load responsive stats
        async function loadResponsiveStats() {
            try {
                const response = await fetch('/responsive/stats');
                const stats = await response.json();
                
                const statsHtml = `
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">Templates Processed</div>
                            <div class="info-value">${stats.templates_processed || 0}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">CSS Cache Size</div>
                            <div class="info-value">${stats.css_cache_size || 0}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Last Generation</div>
                            <div class="info-value">${stats.last_generation ? new Date(stats.last_generation).toLocaleString() : 'Never'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Service Status</div>
                            <div class="info-value">${stats.last_generation ? 'Active' : 'Inactive'}</div>
                        </div>
                    </div>
                `;
                
                document.getElementById('responsiveStats').innerHTML = statsHtml;
            } catch (error) {
                document.getElementById('responsiveStats').innerHTML = '<div class="text-danger">Failed to load stats</div>';
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateResponsiveInfo();
            updateBreakpointIndicator();
            loadResponsiveStats();
            
            // Listen for breakpoint changes from responsive automation
            window.addEventListener('breakpointChange', function(event) {
                updateBreakpointIndicator();
            });
        });
        
        // Auto-update on window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth !== currentViewportWidth) {
                document.getElementById('viewportWidth').value = window.innerWidth;
                updateViewport();
            }
        });
    </script>
</body>
</html> 